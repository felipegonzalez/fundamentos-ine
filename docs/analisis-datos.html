<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.466">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Fundamentos de estadística - 3&nbsp; Análisis exploratorio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sín resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la busqueda",
    "search-hide-matches-text": "Esconder resultados adicionales",
    "search-more-match-text": "hay más resultados en este documento",
    "search-more-matches-text": "más resultados en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Eviar"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script src="site_libs/quarto-nav/quarto-nav.js"></script><script src="site_libs/quarto-nav/headroom.min.js"></script><script src="site_libs/clipboard/clipboard.min.js"></script><script src="site_libs/quarto-search/autocomplete.umd.js"></script><script src="site_libs/quarto-search/fuse.min.js"></script><script src="site_libs/quarto-search/quarto-search.js"></script><meta name="quarto:offset" content="./"><link href="/inferencia.html" rel="next"><link href="/categoricos.html" rel="prev"><script src="site_libs/quarto-html/quarto.js"></script><script src="site_libs/quarto-html/popper.min.js"></script><script src="site_libs/quarto-html/tippy.umd.min.js"></script><script src="site_libs/quarto-html/anchor.min.js"></script><link href="site_libs/quarto-html/tippy.css" rel="stylesheet"><link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><script src="site_libs/bootstrap/bootstrap.min.js"></script><link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet"><link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet"></head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Análisis exploratorio</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Fundamentos de estadística</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introducción</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./numericos.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Datos numéricos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./categoricos.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Datos categóricos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analisis-datos.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Análisis exploratorio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inferencia.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inferencia estadística</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pruebas-hipotesis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Pruebas de hipótesis</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./remuestreo-bootstrap.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Remuestreo</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-bayesiana-1.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Introducción a inferencia bayesiana</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-bayesiana-2.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Calibración bayesiana y Regularización</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Indice de contenidos</h2>
   
  <ul>
  <li><a href="#ejemplo-nacimientos" id="toc-ejemplo-nacimientos" class="nav-link active" data-scroll-target="#ejemplo-nacimientos"> <span class="header-section-number">3.1</span> Ejemplo: nacimientos</a></li>
  <li><a href="#procesos-generadores-de-datos" id="toc-procesos-generadores-de-datos" class="nav-link" data-scroll-target="#procesos-generadores-de-datos">Procesos generadores de datos</a></li>
  <li><a href="#ejemplo-cálculos-renales" id="toc-ejemplo-cálculos-renales" class="nav-link" data-scroll-target="#ejemplo-cálculos-renales">Ejemplo (cálculos renales)</a></li>
  <li><a href="#ejemplo" id="toc-ejemplo" class="nav-link" data-scroll-target="#ejemplo">Ejemplo</a></li>
  <li><a href="#inferencia" id="toc-inferencia" class="nav-link" data-scroll-target="#inferencia"> <span class="header-section-number">3.2</span> Inferencia</a></li>
  <li><a href="#ejemplo-más-de-nacimientos-en-méxico" id="toc-ejemplo-más-de-nacimientos-en-méxico" class="nav-link" data-scroll-target="#ejemplo-más-de-nacimientos-en-méxico"> <span class="header-section-number">3.3</span> Ejemplo: más de nacimientos en México</a>
  <ul class="collapse">
  <li><a href="#datos-de-natalidad-para-méxico" id="toc-datos-de-natalidad-para-méxico" class="nav-link" data-scroll-target="#datos-de-natalidad-para-méxico">Datos de natalidad para México</a></li>
  <li><a href="#tendencia" id="toc-tendencia" class="nav-link" data-scroll-target="#tendencia">Tendencia</a></li>
  <li><a href="#componente-anual" id="toc-componente-anual" class="nav-link" data-scroll-target="#componente-anual">Componente anual</a></li>
  <li><a href="#día-de-la-semana" id="toc-día-de-la-semana" class="nav-link" data-scroll-target="#día-de-la-semana">Día de la semana</a></li>
  <li><a href="#residuales" id="toc-residuales" class="nav-link" data-scroll-target="#residuales">Residuales</a></li>
  <li><a href="#reestimación" id="toc-reestimación" class="nav-link" data-scroll-target="#reestimación">Reestimación</a></li>
  <li><a href="#análisis-de-componentes" id="toc-análisis-de-componentes" class="nav-link" data-scroll-target="#análisis-de-componentes">Análisis de componentes</a></li>
  <li><a href="#viernes-13" id="toc-viernes-13" class="nav-link" data-scroll-target="#viernes-13">Viernes 13?</a></li>
  <li><a href="#residuales-antes-y-después-de-2006" id="toc-residuales-antes-y-después-de-2006" class="nav-link" data-scroll-target="#residuales-antes-y-después-de-2006">Residuales: antes y después de 2006</a></li>
  <li><a href="#otros-días-especiales-más-de-residuales" id="toc-otros-días-especiales-más-de-residuales" class="nav-link" data-scroll-target="#otros-días-especiales-más-de-residuales">Otros días especiales: más de residuales</a></li>
  <li><a href="#semana-santa" id="toc-semana-santa" class="nav-link" data-scroll-target="#semana-santa">Semana santa</a></li>
  </ul></li>
  <li><a href="#descripciones-simples-y-problemas-complejos" id="toc-descripciones-simples-y-problemas-complejos" class="nav-link" data-scroll-target="#descripciones-simples-y-problemas-complejos"> <span class="header-section-number">3.4</span> Descripciones simples y problemas complejos</a></li>
  <li><a href="#qué-preguntas-formular" id="toc-qué-preguntas-formular" class="nav-link" data-scroll-target="#qué-preguntas-formular"> <span class="header-section-number">3.5</span> ¿Qué preguntas formular?</a></li>
  <li><a href="#formulación-de-preguntas-y-respuestas" id="toc-formulación-de-preguntas-y-respuestas" class="nav-link" data-scroll-target="#formulación-de-preguntas-y-respuestas"> <span class="header-section-number">3.6</span> Formulación de preguntas y respuestas</a></li>
  <li><a href="#cómo-saber-que-vamos-en-el-camino-correcto" id="toc-cómo-saber-que-vamos-en-el-camino-correcto" class="nav-link" data-scroll-target="#cómo-saber-que-vamos-en-el-camino-correcto"> <span class="header-section-number">3.7</span> ¿Cómo saber que vamos en el camino correcto?</a></li>
  <li><a href="#gráfica-de-minard" id="toc-gráfica-de-minard" class="nav-link" data-scroll-target="#gráfica-de-minard"> <span class="header-section-number">3.8</span> Gráfica de Minard</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="analisis-1" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Análisis exploratorio</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<blockquote class="blockquote">
<p>“Exploratory data analysis can never be the whole story, but nothing else can serve as the foundation stone –as the first step.” — John Tukey</p>
</blockquote>
<p>Muchas veces se le llama <strong>análisis exploratorio</strong> a una combinación de resúmenes, gráficas y tablas cuyos propósitos pueden englobarse en:</p>
<ol type="1">
<li><p><strong>Validación de datos</strong>. Verificar si en los datos existen o no valores imposibles o “extraños” para algunas mediciones, si existen datos faltantes, o existen otros posibles “defectos”, irregularidades o sorpresas.</p></li>
<li><p><strong>Resúmenes compactos</strong>. Mostrar algunas resúmenes útiles y compactos de las mediciones que tenemos: cuáles son valores o rangos de valores comunes, cuáles son los extremos de las mediciones y así sucesivamente.</p></li>
<li><p><strong>Patrones</strong>. Buscamos gráficas o resúmenes que muestren patrones más importantes y sustanciales, como la relación entre distintas partes de los datos, qué partes de la variación en los datos son tentativamente atribuibles a ciertos factores y qué partes no.</p></li>
</ol>
<p>Esta fase del análisis de datos es fundamental, como la cita de Tukey explica arriba, y se caracteríza por un <em>enfoque de detective</em>: quizá tenemos algunas preguntas, algunas sospechas, y en esta fase acumulamos indicios que nos indiquen caminos prometedores de investigación.</p>
<p>En contraste, tenemos el <em>análisis confirmatorio</em>, que busca validar hipótesis o dar respuestas correctamente cuantificadas en cuanto a su incertidumbre o grado de error. En esta parte somos más <em>jueces</em> que detectives, y utilizamos más maquinaria matemática (teoría de probabilidad) para especificar con claridad nuestros supuestos y poder hacer cálculos cuidadosos, generalmente basados en algún tipo de aleatorización.</p>
<p>Ninguno de los dos tipos de análisis funciona muy bien sin el otro, (<span class="citation" data-cites="tukeyexpconf">Tukey (<a href="#ref-tukeyexpconf" role="doc-biblioref">1980</a>)</span>) y explicaremos por qué un poco más adelante. Por el momento, para ilustrar el enfoque exploratorio, comenzaremos con datos que podemos describir de manera completa y efectiva sin necesidad de hacer resúmenes o aplicar técnicas avanzadas.</p>
<section id="ejemplo-nacimientos" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="ejemplo-nacimientos"><span class="header-section-number">3.1</span> Ejemplo: nacimientos</h2>
<p>Consideremos una parte de los datos de nacimientos por día del INEGI de 1999 a 2016. Consideraremos sólo tres meses: enero a marzo de 2016. Estos datos, por su tamaño, pueden representarse de manera razonablemente efectiva en una visualización de serie de tiempo. Examinamos partes del contenido de la tabla:</p>
<div class="cell">

</div>
<p>Examinamos partes del contenido de la tabla:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>tab_1 <span class="ot">&lt;-</span> nacimientos <span class="sc">|&gt;</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>(fecha, n) <span class="sc">|&gt;</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>tab_2 <span class="ot">&lt;-</span> nacimientos <span class="sc">|&gt;</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>(fecha, n) <span class="sc">|&gt;</span> </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">slice_tail</span>(<span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">list</span>(tab_1, tab_2)) <span class="sc">|&gt;</span> <span class="fu">kable_paper</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="kable_wrapper lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<tbody>
  <tr>
   <td> 

<table>
 <thead>
  <tr>
   <th style="text-align:left;"> fecha </th>
   <th style="text-align:right;"> n </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 2016-01-01 </td>
   <td style="text-align:right;"> 3952 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2016-01-02 </td>
   <td style="text-align:right;"> 4858 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2016-01-03 </td>
   <td style="text-align:right;"> 4665 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2016-01-04 </td>
   <td style="text-align:right;"> 5948 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2016-01-05 </td>
   <td style="text-align:right;"> 6087 </td>
  </tr>
</tbody>
</table>

 </td>
   <td> 

<table>
 <thead>
  <tr>
   <th style="text-align:left;"> fecha </th>
   <th style="text-align:right;"> n </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 2016-03-27 </td>
   <td style="text-align:right;"> 4112 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2016-03-28 </td>
   <td style="text-align:right;"> 5805 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2016-03-29 </td>
   <td style="text-align:right;"> 5957 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2016-03-30 </td>
   <td style="text-align:right;"> 5766 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2016-03-31 </td>
   <td style="text-align:right;"> 5497 </td>
  </tr>
</tbody>
</table>

 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>En un examen rápido de estos números no vemos nada fuera de orden. Los datos tienen forma de serie de tiempo regularmente espaciada (un dato para cada día). Podemos graficar de manera simple como sigue:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nacimientos, <span class="fu">aes</span>(<span class="at">x =</span> fecha, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_date</span>(<span class="at">breaks =</span> <span class="st">"1 week"</span>, <span class="at">date_labels =</span> <span class="st">"%d-%b"</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="analisis-datos_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<p>Esta es una descripción de los datos, que quizá no es muy compacta pero muestra varios aspectos importantes. En este caso notamos algunos patrones que saltan a la vista. Podemos marcar los domingos de cada semana:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>domingos_tbl <span class="ot">&lt;-</span> nacimientos <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="fu">weekdays</span>(fecha) <span class="sc">==</span> <span class="st">"Sunday"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nacimientos, <span class="fu">aes</span>(<span class="at">x =</span> fecha, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> fecha), domingos_tbl, <span class="at">colour =</span> <span class="st">"salmon"</span>) <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_x_date</span>(<span class="at">breaks =</span> <span class="st">"1 week"</span>, <span class="at">date_labels =</span> <span class="st">"%d-%b"</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="analisis-datos_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<p>Observamos que los domingos ocurren menos nacimientos y los sábados también ocurren relativamente menos nacimentos. ¿Por qué crees que sea esto?</p>
<p>Adicionalmente a estos patrones observamos otros aspectos interesantes:</p>
<ul>
<li>El primero de enero hay considerablemente menos nacimientos de los que esperaríamos para un viernes. ¿Por qué?</li>
<li>El primero de marzo hay un exceso de nacimientos considerable. ¿Qué tiene de especial este primero de marzo?</li>
<li>¿Cómo describirías lo que sucede en la semana que comienza el 21 de marzo? ¿Por qué crees que pase eso?</li>
<li>¿Cuáles son los domingos con más nacimientos? ¿Qué tienen de especial y qué explicación puede tener?</li>
</ul>
<p>La confirmación de estas hipótesis, dependiendo de su forma, puede ser relativamente simple (por ejemplo ver una serie más larga de domingos comparados con otros días de la semana) hasta muy compleja (investigar preferencias de madres, de doctores o de hospitales, costumbres y actitudes, procesos en el registro civil, etc.)</p>
</section>
<section id="procesos-generadores-de-datos" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="procesos-generadores-de-datos">Procesos generadores de datos</h2>
<p>De este primer ejemplo donde usamos una gráfica simple, vemos que una visión descontextualizada de estos datos no tiene mucha utilidad</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
El proceso generador de datos
</div>
</div>
<div class="callout-body-container callout-body">
<p>Nótese que en todas estas preguntas hemos tenido que recurrir a conocimientos generales y de dominio para interpretar y hacer hipótesis acerca de lo que vemos en la gráfica. Las explicaciones son típicamente complejas e intervienen distintos aspectos del comportamiento de actores, sistemas, y métodos de recolección de datos involucrados.</p>
<p>Al conjunto de esos aspectos que determinan los datos que finalmente observamos le llamamos el <strong>proceso generador de datos</strong>.</p>
</div>
</div>
<p>El análisis de datos en general busca entender las partes importantes del proceso que los generó. En el análisis descriptivo y exploratorio buscamos iluminar ese proceso, proponer hipótesis y buscar caminos interesantes para investigar, ya sea con técnicas cuantitativas o con trabajo de campo (como sugiere el título de artículo de David A. Friedman: <a href="https://psychology.okstate.edu/faculty/jgrice/psyc5314/Freedman_1991A.pdf">Statistical Models and Shoe Leather</a>).</p>
<p>Con la teoría de probabilidades podemos modelar más explícitamente partes de estos procesos generadores de datos, especialmente cuando controlamos parte de ese proceso generador mediante técnicas estadísticas de diseño, por ejemplo, usando aleatorización.</p>
</section>
<section id="ejemplo-cálculos-renales" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="ejemplo-cálculos-renales">Ejemplo (cálculos renales)</h2>
<p>En este ejemplo también intentaremos mostrar los datos completos sin intentar resumir.</p>
<p>Este es un estudio real acerca de tratamientos para cálculos renales (<span class="citation" data-cites="kidney94">Julious y Mullee (<a href="#ref-kidney94" role="doc-biblioref">1994</a>)</span>). Pacientes se asignaron de una forma no controlada a dos tipos de tratamientos para reducir cálculos renales. Para cada paciente, conocemos el el tipo de ćalculos que tenía (grandes o chicos) y si el tratamiento tuvo éxito o no.</p>
<p>La tabla original se ve como sigue (muestreamos algunos renglones):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>calculos <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"./datos/kidney_stone_data.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(calculos) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tratamiento"</span>, <span class="st">"tamaño"</span>, <span class="st">"éxito"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>calculos <span class="ot">&lt;-</span> calculos <span class="sc">|&gt;</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(tamaño <span class="ot">=</span> <span class="fu">ifelse</span>(tamaño <span class="sc">==</span> <span class="st">"large"</span>, <span class="st">"grandes"</span>, <span class="st">"chicos"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">resultado =</span> <span class="fu">ifelse</span>(éxito <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"mejora"</span>, <span class="st">"sin_mejora"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>(tratamiento, tamaño, resultado)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(calculos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 700</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>calculos <span class="sc">|&gt;</span> <span class="fu">sample_n</span>(<span class="dv">15</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">kable</span>() <span class="sc">|&gt;</span> <span class="fu">kable_paper</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> tratamiento </th>
   <th style="text-align:left;"> tamaño </th>
   <th style="text-align:left;"> resultado </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> grandes </td>
   <td style="text-align:left;"> sin_mejora </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> chicos </td>
   <td style="text-align:left;"> mejora </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> chicos </td>
   <td style="text-align:left;"> mejora </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> grandes </td>
   <td style="text-align:left;"> mejora </td>
  </tr>
  <tr>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> grandes </td>
   <td style="text-align:left;"> sin_mejora </td>
  </tr>
  <tr>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> grandes </td>
   <td style="text-align:left;"> mejora </td>
  </tr>
  <tr>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> chicos </td>
   <td style="text-align:left;"> mejora </td>
  </tr>
  <tr>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> chicos </td>
   <td style="text-align:left;"> mejora </td>
  </tr>
  <tr>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> grandes </td>
   <td style="text-align:left;"> mejora </td>
  </tr>
  <tr>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> grandes </td>
   <td style="text-align:left;"> sin_mejora </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> chicos </td>
   <td style="text-align:left;"> mejora </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> chicos </td>
   <td style="text-align:left;"> mejora </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> grandes </td>
   <td style="text-align:left;"> mejora </td>
  </tr>
  <tr>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> grandes </td>
   <td style="text-align:left;"> mejora </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> chicos </td>
   <td style="text-align:left;"> mejora </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Aunque estos datos contienen información de 700 pacientes (cada renglón es un paciente), los datos pueden resumirse sin pérdida de información contando como sigue:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>calculos_agregada <span class="ot">&lt;-</span> calculos <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(tratamiento, tamaño, resultado) <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">count</span>()</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>calculos_agregada <span class="sc">|&gt;</span> <span class="fu">kable</span>() <span class="sc">|&gt;</span> <span class="fu">kable_paper</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> tratamiento </th>
   <th style="text-align:left;"> tamaño </th>
   <th style="text-align:left;"> resultado </th>
   <th style="text-align:right;"> n </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> chicos </td>
   <td style="text-align:left;"> mejora </td>
   <td style="text-align:right;"> 81 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> chicos </td>
   <td style="text-align:left;"> sin_mejora </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> grandes </td>
   <td style="text-align:left;"> mejora </td>
   <td style="text-align:right;"> 192 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> grandes </td>
   <td style="text-align:left;"> sin_mejora </td>
   <td style="text-align:right;"> 71 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> chicos </td>
   <td style="text-align:left;"> mejora </td>
   <td style="text-align:right;"> 234 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> chicos </td>
   <td style="text-align:left;"> sin_mejora </td>
   <td style="text-align:right;"> 36 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> grandes </td>
   <td style="text-align:left;"> mejora </td>
   <td style="text-align:right;"> 55 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> grandes </td>
   <td style="text-align:left;"> sin_mejora </td>
   <td style="text-align:right;"> 25 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Este resumen no es muy informativo, pero al menos vemos qué valores aparecen en cada columna de la tabla. Como en este caso nos interesa principalmente la tasa de éxito de cada tratamiento, podemos mejorar mostrando como sigue:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>calculos_agregada <span class="sc">|&gt;</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> resultado, <span class="at">values_from =</span> n) <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">total =</span> mejora <span class="sc">+</span> sin_mejora) <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">prop_mejora =</span> <span class="fu">round</span>(mejora <span class="sc">/</span> total, <span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>(tratamiento, tamaño, total, prop_mejora) <span class="sc">|&gt;</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">arrange</span>(tamaño) <span class="sc">|&gt;</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">kable</span>() <span class="sc">|&gt;</span> <span class="fu">kable_paper</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> tratamiento </th>
   <th style="text-align:left;"> tamaño </th>
   <th style="text-align:right;"> total </th>
   <th style="text-align:right;"> prop_mejora </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> chicos </td>
   <td style="text-align:right;"> 87 </td>
   <td style="text-align:right;"> 0.93 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> chicos </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 0.87 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> grandes </td>
   <td style="text-align:right;"> 263 </td>
   <td style="text-align:right;"> 0.73 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> grandes </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> 0.69 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Esta tabla descriptiva es una reescritura de los datos, y no hemos resumido nada todavía. Sin embargo, esta tabla es apropiada para empezar a contestar la pregunta:</p>
<ul>
<li>¿Qué indican estos datos acerca de qué tratamiento es mejor? ¿Acerca del tamaño de cálculos grandes o chicos?</li>
</ul>
<p>Supongamos que otro analista decide comparar los pacientes que recibieron cada tratamiento, ignorando la variable de tamaño:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>calculos <span class="sc">|&gt;</span> <span class="fu">group_by</span>(tratamiento) <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">prop_mejora =</span> <span class="fu">mean</span>(resultado <span class="sc">==</span> <span class="st">"mejora"</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">kable</span>() <span class="sc">|&gt;</span> <span class="fu">kable_paper</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> tratamiento </th>
   <th style="text-align:right;"> prop_mejora </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> A </td>
   <td style="text-align:right;"> 0.78 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:right;"> 0.83 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>y parece ser que el tratamiento <span class="math inline">\(B\)</span> es mejor que el <span class="math inline">\(A\)</span>. Esta es una paradoja (un ejemplo de la <a href="https://es.wikipedia.org/wiki/Paradoja_de_Simpson">paradoja de Simpson</a>) . Si un médico no sabe que tipo de cálculos tiene el paciente, ¿entonces debería recetar <span class="math inline">\(B\)</span>? ¿Si sabe debería recetar <span class="math inline">\(A\)</span>? Esta discusión parece no tener mucho sentido.</p>
<p>Podemos investigar por qué está pasando esto considerando la siguiente tabla, que solo examina cómo se asignó el tratamiento dependiendo del tipo de cálculos de cada paciente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>calculos <span class="sc">|&gt;</span> <span class="fu">group_by</span>(tratamiento, tamaño) <span class="sc">|&gt;</span> <span class="fu">count</span>() <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">kable</span>() <span class="sc">|&gt;</span> <span class="fu">kable_paper</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> tratamiento </th>
   <th style="text-align:left;"> tamaño </th>
   <th style="text-align:right;"> n </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> chicos </td>
   <td style="text-align:right;"> 87 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> grandes </td>
   <td style="text-align:right;"> 263 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> chicos </td>
   <td style="text-align:right;"> 270 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> grandes </td>
   <td style="text-align:right;"> 80 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Nuestra hipótesis aquí es que la decisión de qué tratamiento usar depende del tamaño de los cálculos. En este caso, por alguna razón se prefiere utilizar el tratamiento <span class="math inline">\(A\)</span> para cálculos grandes, y <span class="math inline">\(B\)</span> para cálculos chicos. Esto quiere decir que en la tabla total <em>el tratamiento <span class="math inline">\(A\)</span> está en desventaja porque se usa en casos más difíciles</em>, pero el tratamiento <span class="math inline">\(A\)</span> parece ser en general mejor.</p>
<p>Igual que en el ejemplo anterior, los resúmenes descriptivos están acompañados de hipótesis acerca del <em>proceso generador de datos</em>, y esto ilumina lo que estamos observando y nos guía hacia descripciones provechosas de los datos. Las explicaciones no son tan simples y, otra vez, interviene el comportamiento de doctores, tratamientos, y distintos tipos de padecimientos.</p>
</section>
<section id="ejemplo" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="ejemplo">Ejemplo</h2>
<p>Ahora supongamos que tenemos datos de un tratamiento para mejorar enfermedades de corazón. En el estudio también se mide, durante la duración del estudio, si la presión del paciente es alta o baja. Supongamos otra vez que tenemos dos tratamientos, A y B, y obtenemos los siguientes resultados:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>corazon <span class="ot">&lt;-</span> calculos <span class="sc">|&gt;</span> <span class="fu">rename</span>(presión <span class="ot">=</span> tamaño) <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(presión <span class="ot">=</span> <span class="fu">recode</span>(presión, <span class="at">chicos =</span> <span class="st">"baja"</span>, <span class="at">grandes =</span> <span class="st">"alta"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> tratamiento </th>
   <th style="text-align:left;"> presión </th>
   <th style="text-align:right;"> total </th>
   <th style="text-align:right;"> prop_mejora </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> alta </td>
   <td style="text-align:right;"> 263 </td>
   <td style="text-align:right;"> 0.73 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> alta </td>
   <td style="text-align:right;"> 80 </td>
   <td style="text-align:right;"> 0.69 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> A </td>
   <td style="text-align:left;"> baja </td>
   <td style="text-align:right;"> 87 </td>
   <td style="text-align:right;"> 0.93 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:left;"> baja </td>
   <td style="text-align:right;"> 270 </td>
   <td style="text-align:right;"> 0.87 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>corazon <span class="sc">|&gt;</span> <span class="fu">group_by</span>(tratamiento) <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">summarise</span>(<span class="at">prop_mejora =</span> <span class="fu">mean</span>(resultado <span class="sc">==</span> <span class="st">"mejora"</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">kable</span>() <span class="sc">|&gt;</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">kable_paper</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> tratamiento </th>
   <th style="text-align:right;"> prop_mejora </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> A </td>
   <td style="text-align:right;"> 0.78 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> B </td>
   <td style="text-align:right;"> 0.83 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<ul>
<li>En este ejemplo, ¿cuál es el análisis más apropiado? ¿Qué cosas necesitarías saber para tomar una decisión?</li>
<li>¿En qué es diferente o similar al caso de los cálculos renales?</li>
</ul>
</section>
<section id="inferencia" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="inferencia"><span class="header-section-number">3.2</span> Inferencia</h2>
<p>En los ejemplos anteriores, sólo vimos muestras de datos (algunos pacientes, algunas fechas). Nuestras descripciones son, estrictamente hablando, válidas para esa muestra de los datos.</p>
<p>Si quisiéramos generalizar a la población gneral de pacientes con cálculos (quizá en nuestra muestra el tratamiento A parece mejor, pero ¿qué podemos decir para la población de pacientes?), o quisiéramos predecir cómo van a ser los nacimientos en 2021, requerimos hacer <strong>inferencia</strong>. Este tipo de análisis, central en la estadística, busca establecer condiciones para poder generalizar de nuestra muestra a datos no observados (otros pacientes, nacimientos en el futuro), y cuantificar qué tan bien o mal podemos hacerlo.</p>
<p>Para llegar a este tipo de análisis, generalmente tenemos que comenzar con el análisis exploratorio, y con la comprensión de los fundamentos del proceso generador asociado a nuestros datos. En algunos casos, veremos que es posible usar herramientas matemáticas para modelar aspectos de nuestro proceso generador de datos, que cuando son válidas, nos permiten generalizar y ampliar apropiadamente el rango de nuestras conclusiones.</p>
<p>La herramienta básica para construir, entender y operar con estos modelos es la <strong>teoría de probabilidad</strong>, que veremos más adelante.</p>
</section>
<section id="ejemplo-más-de-nacimientos-en-méxico" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="ejemplo-más-de-nacimientos-en-méxico"><span class="header-section-number">3.3</span> Ejemplo: más de nacimientos en México</h2>
<p>Este ejemplo sigue sigue ideas de un análisis de <a href="https://statmodeling.stat.columbia.edu/2016/05/18/birthday-analysis-friday-the-13th-update/">A. Vehtari y A. Gelman</a>, junto con análisis de serie de tiempo de <span class="citation" data-cites="ClevelandVis">Cleveland (<a href="#ref-ClevelandVis" role="doc-biblioref">1993</a>)</span></p>
<p>Usaremos los datos de nacimientos registrados por día en México, desde 1999. Haremos una pregunta como ¿cuáles son los cumpleaños más frecuentes?, o ¿Qué mes del año hay más nacimientos?</p>
<p>Una gráfica popular (ver por ejemplo <a href="http://thedailyviz.com/2016/09/17/how-common-is-your-birthday-dailyviz/">esta visualización</a>):</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="./imagenes/heatmapbirthdays1.png" class="img-fluid"></p>
</div>
</div>
<p>¿Cómo criticarías este análisis desde el punto de vista de los tres primeros principios del diseño analítico? ¿Las comparaciones son útiles? ¿Hay aspectos multivariados? ¿Qué tan bien explica o sugiere estructura, mecanismos o causalidad?</p>
<section id="datos-de-natalidad-para-méxico" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="datos-de-natalidad-para-méxico">Datos de natalidad para México</h3>
<div class="cell">

</div>
<p>Consideramos los datos agregados de número de nacimientos (registrados) por día desde 1999 hasta 2016.</p>
<p>Podemos hacer una primera gráfica de la serie de tiempo que no es muy útil:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="analisis-datos_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>Hay varias características que notamos. Principalmente, la tendencia ligeramente decreciente de número de nacimientos a lo largo de los años, un patrón anual, dispersión producida por los días de la semana.</p>
<p>Solo estas características hacen que la comparación entre días sea una difícil de interpretar. Supongamos que comparamos el número de nacimientos de dos miércoles dados. Esa comparación será diferente dependiendo del año donde ocurrieron, el mes donde ocurrieron, si semana santa ocurrió en algunos de los miércoles, y así sucesivamente.</p>
<p>Como en nuestros ejemplos anteriores, la idea del siguiente análisis es aislar las componentes que observamos en la serie de tiempo: extraemos componentes ajustadas, y luego examinamos los residuales.</p>
<p>En este caso particular, construiremos una <strong>descomposición aditiva</strong> de la serie de tiempo (<span class="citation" data-cites="ClevelandVis">Cleveland (<a href="#ref-ClevelandVis" role="doc-biblioref">1993</a>)</span>).</p>
</section>
<section id="tendencia" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="tendencia">Tendencia</h3>
<p>Comenzamos por extraer la tendencia, haciendo promedios loess con vecindades relativamente grandes. Quizá preferiríamos suavizar menos para capturar más variación lenta, pero si hacemos esto en este punto empezamos a absorber parte de la componente anual:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mod_1 <span class="ot">&lt;-</span> <span class="fu">loess</span>(n <span class="sc">~</span> <span class="fu">as.numeric</span>(fecha), <span class="at">data =</span> natalidad, <span class="at">span =</span> <span class="fl">0.2</span>, <span class="at">degree =</span> <span class="dv">1</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>datos_dia <span class="ot">&lt;-</span> natalidad <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">ajuste_1 =</span> <span class="fu">fitted</span>(mod_1)) <span class="sc">|&gt;</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">res_1 =</span> n <span class="sc">-</span> ajuste_1)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="analisis-datos_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>A principios de 2000 el suavizador está en niveles de alrededor de 7000 nacimientos diarios, hacia 2015 ese número es más cercano a unos 6000.</p>
</section>
<section id="componente-anual" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="componente-anual">Componente anual</h3>
<p>Restamos a la serie la tendencia, y así obtenemos mejores comparaciones controlando por tendencia (por ejemplo, comparar un día de 2000 y de 2015 tendria más sentido). Ahora ajustamos <strong>los residuales del suavizado anterior</strong>, pero con menos suavizamiento. Así evitamos capturar tendencia:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mod_anual <span class="ot">&lt;-</span> <span class="fu">loess</span>(res_1 <span class="sc">~</span> <span class="fu">as.numeric</span>(fecha), <span class="at">data =</span> datos_dia, <span class="at">degree =</span> <span class="dv">2</span>, <span class="at">span =</span> <span class="fl">0.005</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>datos_dia <span class="ot">&lt;-</span> datos_dia <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">ajuste_2 =</span> <span class="fu">fitted</span>(mod_anual)) <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">res_2 =</span> res_1 <span class="sc">-</span> ajuste_2)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="analisis-datos_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="día-de-la-semana" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="día-de-la-semana">Día de la semana</h3>
<p>Ahora podemos capturar el efecto de día de la semana. En este caso, podemos hacer suavizamiento loess para cada serie independiente</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>datos_dia <span class="ot">&lt;-</span> datos_dia <span class="sc">|&gt;</span> <span class="fu">group_by</span>(dia_semana) <span class="sc">|&gt;</span> <span class="fu">nest</span>() <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ajuste_mod =</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">map</span>(data, <span class="sc">~</span> <span class="fu">loess</span>(res_2 <span class="sc">~</span> <span class="fu">as.numeric</span>(fecha), <span class="at">data =</span> .x, <span class="at">span =</span> <span class="fl">0.1</span>, <span class="at">degree =</span> <span class="dv">1</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ajuste_3 =</span>  <span class="fu">map</span>(ajuste_mod, fitted)) <span class="sc">|&gt;</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>ajuste_mod) <span class="sc">|&gt;</span> <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(data, ajuste_3)) <span class="sc">|&gt;</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">res_3 =</span> res_2 <span class="sc">-</span> ajuste_3) <span class="sc">|&gt;</span> <span class="fu">ungroup</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="analisis-datos_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
<section id="residuales" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="residuales">Residuales</h3>
<p>Examinamos los residuales finales quitando los efectos ajustados:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_dia, <span class="fu">aes</span>(<span class="at">x =</span> fecha, <span class="at">y =</span> res_3)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">span =</span> <span class="fl">0.02</span>, </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">degree=</span><span class="dv">1</span>, <span class="at">family =</span> <span class="st">"symmetric"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="analisis-datos_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Observación</strong>: nótese que la distribución de estos residuales tiene irregularidades interesante: es una distribución con colas largas, y no se debe a unos cuantos atípicos. Esto generalmente es indicación que hay factores importantes que hay que examinar en los residuales:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="analisis-datos_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="384"></p>
</div>
</div>
</section>
<section id="reestimación" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="reestimación">Reestimación</h3>
<p>Cuando hacemos este proceso secuencial ajuste -&gt; residual, a veces conviene iterarlo. La razón es que un una segunda o tercera pasada podemos hacer mejores estimaciones de cada componente, y es posible suavizar menos sin capturar componentes de más alta frecuencia.</p>
<p>Así que podemos regresar a la serie original para hacer mejores estimaciones, más suavizadas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quitamos componente anual y efecto de día de la semana</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>datos_dia <span class="ot">&lt;-</span> datos_dia <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">n_1 =</span> n <span class="sc">-</span> ajuste_2 <span class="sc">-</span> ajuste_3)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># reajustamos</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>mod_1 <span class="ot">&lt;-</span> <span class="fu">loess</span>(n_1 <span class="sc">~</span> <span class="fu">as.numeric</span>(fecha), <span class="at">data =</span> datos_dia, <span class="at">span =</span> <span class="fl">0.02</span>, <span class="at">degree =</span> <span class="dv">2</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="st">"symmetric"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="analisis-datos_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>mod_anual <span class="ot">&lt;-</span> <span class="fu">loess</span>(n_2 <span class="sc">~</span> <span class="fu">as.numeric</span>(fecha), <span class="at">data =</span> datos_dia, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">degree =</span> <span class="dv">2</span>,  <span class="at">span =</span> <span class="fl">0.01</span>, <span class="at">family =</span> <span class="st">"symmetric"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>datos_dia <span class="ot">&lt;-</span> datos_dia <span class="sc">|&gt;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ajuste_5 =</span> <span class="fu">fitted</span>(mod_anual)) <span class="sc">|&gt;</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">res_5 =</span> n_2 <span class="sc">-</span> ajuste_5) <span class="sc">|&gt;</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">n_3 =</span> n <span class="sc">-</span> ajuste_4 <span class="sc">-</span> ajuste_5)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="analisis-datos_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Y ahora repetimos con la componente de día de la semana:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="analisis-datos_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="análisis-de-componentes" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="análisis-de-componentes">Análisis de componentes</h3>
<p>Ahora comparamos las componentes estimadas y los residuales en una misma gráfica. La suma de todas estas componentes da los datos originales: es una descomposición aditiva.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="analisis-datos_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Y esto nos da muchas comparaciones buenas que explican la variación que vimos en los datos. Una gran parte de los residuales está entre +-/250 nacimientos por día, pero las colas tienen una dispersión mucho mayor:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(datos_dia<span class="sc">$</span>res_6, <span class="fu">c</span>(<span class="dv">00</span>, .<span class="dv">01</span>,<span class="fl">0.05</span>, <span class="fl">0.10</span>, <span class="fl">0.90</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>, <span class="dv">1</span>)) <span class="sc">|&gt;</span> <span class="fu">round</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   0%    1%    5%   10%   90%   95%   99%  100% 
-2238 -1134  -315  -202   188   268   516  2521 </code></pre>
</div>
</div>
<p>¿A qué se deben estas colas tan largas?</p>
<div class="cell">

</div>
</section>
<section id="viernes-13" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="viernes-13">Viernes 13?</h3>
<p>Podemos empezar con una curosidad: En Viernes o Martes 13, ¿nacen menos niños?</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="analisis-datos_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>Nótese que fue útil agregar el indicador de Semana santa por el Viernes 13 de Semana Santa que se ve como un atípico en el panel de los viernes 13.</p>
</section>
<section id="residuales-antes-y-después-de-2006" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="residuales-antes-y-después-de-2006">Residuales: antes y después de 2006</h3>
<p>Veamos primero una agregación sobre los años de los residuales. Lo primero es observar un cambio que sucedió repentinamente en 2006:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>sept_1 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="fu">paste0</span>(<span class="dv">2000</span><span class="sc">:</span><span class="dv">2016</span>, <span class="st">"-09-01"</span>)) <span class="sc">|&gt;</span> <span class="fu">yday</span>()</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>datos_dia <span class="ot">&lt;-</span> datos_dia <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">antes_2006 =</span> <span class="fu">ifelse</span>(año <span class="sc">&lt;</span> <span class="dv">2006</span>, <span class="st">"Antes de 2006"</span>, <span class="st">"2006 en adelante"</span>))</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_dia , <span class="fu">aes</span>(<span class="at">x =</span> dia_año, <span class="at">y =</span> res_6, <span class="at">group =</span> <span class="fu">factor</span>(año))) <span class="sc">+</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> sept_1, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>( <span class="sc">~</span> antes_2006, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Residual: exceso de nacimientos"</span>) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">260</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">1500</span>, <span class="at">label =</span> <span class="st">"Sept 1"</span>, <span class="at">colour =</span> <span class="st">"red"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="analisis-datos_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>La razón es un cambio en la ley acerca de cuándo pueden entrar los niños a la primaria. Antes era por edad y había poco margen. Ese exceso de nacimientos son reportes falsos para que los niños no tuvieran que esperar un año completo por haber nacido unos cuantos días antes de la fecha límite.</p>
<p>Otras características que debemos investigar:</p>
<ul>
<li>Efectos de Año Nuevo, Navidad, Septiembre 16 y otros días feriados como Febrero 14.</li>
<li>Semana santa: como la fecha cambia, vemos que los residuales negativos tienden a ocurrir dispersos alrededor del día 100 del año.</li>
</ul>
</section>
<section id="otros-días-especiales-más-de-residuales" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="otros-días-especiales-más-de-residuales">Otros días especiales: más de residuales</h3>
<p>Ahora promediamos residuales (es posible agregar barras para indicar dispersión a lo largo de los años) para cada día del año. Podemos identificar ahora los residuales más grandes: se deben, por ejemplo, a días feriados, con consecuencias adicionales que tienen en días ajuntos (excesos de nacimientos):</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'dia_año_366', 'antes_2006'. You can
override using the `.groups` argument.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="analisis-datos_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
<section id="semana-santa" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="semana-santa">Semana santa</h3>
<p>Para Semana Santa tenemos que hacer unos cálculos. Si alineamos los datos por días antes de Domingo de Pascua, obtenemos un patrón de caída fuerte de nacimientos el Viernes de Semana Santa, y la característica forma de “valle con hombros” en días anteriores y posteriores estos Viernes. ¿Por qué ocurre este patrón?</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="analisis-datos_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Nótese un defecto de nuestro modelo: el patrón de “hombros” alrededor del Viernes Santo no es suficientemente fuerte para equilibrar los nacimientos faltantes. ¿Cómo podríamos mejorar nuestra descomposición?</p>
</section>
</section>
<section id="descripciones-simples-y-problemas-complejos" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="descripciones-simples-y-problemas-complejos"><span class="header-section-number">3.4</span> Descripciones simples y problemas complejos</h2>
<p>Muchas veces se descarta al análisis descriptivo o exploratorio (al menos en sus formas más crudas) como algo que no requiere mucha habilidad técnica o conocimiento de dominio, o cuando se quiere evitar plantear hipótesis claras acerca de los datos que ayuden en su entendimiento.</p>
<p>En realidad el análisis descriptivo y exploratorio es crucial en el análisis de datos en general, y tiene siempre que venir acompañado de conocimiento de dominio, habilidad técnica, una mente crítica y muchas veces ingenio y creatividad.</p>
</section>
<section id="qué-preguntas-formular" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="qué-preguntas-formular"><span class="header-section-number">3.5</span> ¿Qué preguntas formular?</h2>
<p>Existen algunas prácticas generales que utilizamos para hacer validaciones y resúmenes simples de los datos que discutiremos más adelante. Por el momento, discutimos las razones por las que estamos haciendo ese análisis en un principio.</p>
<p>En general, comenzamos con algunas preguntas básicas que quisiéramos contestar con los datos. El análisis exploratorio juega un papel central para comenzar a responder:</p>
<ul>
<li>¿Es razonable la pregunta que queremos contestar?</li>
<li>¿Podemos contestar la pregunta con los datos que tenemos?</li>
</ul>
<p>Aunque estos dos incisos a veces parecen transparentes y simples de contestar, generalmente no lo son: las preguntas que queremos contestar y los problemas que queremos resolver usualmente son no triviales.</p>
</section>
<section id="formulación-de-preguntas-y-respuestas" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="formulación-de-preguntas-y-respuestas"><span class="header-section-number">3.6</span> Formulación de preguntas y respuestas</h2>
<p>El proceso de la ciencia de datos no va desde las preguntas hasta las respuestas en un camino lineal.</p>
<p>En esta gráfica <a href="https://simplystatistics.org/2019/04/17/tukey-design-thinking-and-better-questions">Roger Peng</a> hay tres caminos: uno es uno ideal que pocas veces sucede, otro produce respuestas poco útiles pero es fácil, y otro es tortuoso pero que caracteriza el mejor trabajo de análisis de datos:</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="analisis-datos_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Adaptado de R. Peng: Tukey, design thinking and better questions</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>El proceso típico involucra pasos como los siguientes, y es un proceso <strong>no lineal</strong>:</p>
<ul>
<li>Hacer preguntas de la materia que nos interesa</li>
<li>Recolectar, consumir y procesar los datos para abordarla</li>
<li>Explorar estos datos y evaluar su calidad</li>
<li>Hacer análisis o modelos</li>
<li>Reportar los resultados de forma adecuada y con esto resolver y replantear las preguntas importantes.</li>
</ul>
<p>Por ejemplo, evaluar la calidad de los datos puede llevar a replantear la necesidad de obtener más información o de hacer estudios específicos. Así también, los modelos pueden dar luz sobre las preguntas que los originan.</p>
<div class="cell" type="comentario">

<div class="comentario">
¿Por dónde empezar el análisis descriptivo y exploratorio? ¿Cómo sabemos que vamos por buen camino y qué hacer cuando sentimos que nos estancamos?
</div>
</div>
</section>
<section id="cómo-saber-que-vamos-en-el-camino-correcto" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="cómo-saber-que-vamos-en-el-camino-correcto"><span class="header-section-number">3.7</span> ¿Cómo saber que vamos en el camino correcto?</h2>
<p>Comenzamos por discribir cuáles son los signos de calidad del análisis que piensa usarse como insumo para una decisión. Los principios del diseño analítico de Edward Tufte (<span class="citation" data-cites="tufte06">Tufte (<a href="#ref-tufte06" role="doc-biblioref">2006</a>)</span>) son:</p>
<p>Los análisis exitosos:</p>
<ol type="1">
<li>Muestran y explotan <strong>comparaciones</strong>, diferencias y variación.</li>
<li>Tienden a ser <strong>multivariados</strong>: estudian conjuntamente más de 1 o 2 variables.</li>
<li>Muestran y explotan <strong>estructura sistemática</strong>, sugieren explicaciones. Cuando es posible, aportan evidencia de causalidad.</li>
</ol>
<p>También muy importantes pero en los que pondremos menos énfasis:</p>
<ol start="4" type="1">
<li>Datos y procesos están bien <strong>documentados</strong>. El análisis es reproducible y transparente.</li>
<li>Intentan <strong>integrar</strong> la evidencia completa: teoría, texto, explicaciones, tablas y gráficas.</li>
</ol>
<p>Y finalmente, el principio general:</p>
<ol start="6" type="1">
<li>La calidad, relevancia, e integridad del contenido y los datos son los que al final sostienen al análisis - por sí mismos, <strong>el uso de técnicas sofisticadas, algoritmos novedosos, uso o no de grandes datos, estilo de visualizaciones o presentaciones no son marcas o sellos de un análisis de datos exitoso</strong>.</li>
</ol>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Evaluar un análisis o resultado en estos seis puntos generalmente ayuda en el proceso de refinamiento de preguntas y respuestas.</p>
</div>
</div>
</section>
<section id="gráfica-de-minard" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="gráfica-de-minard"><span class="header-section-number">3.8</span> Gráfica de Minard</h2>
<p>La ilustración que Tufte usa para mostrar excelencia en diseño analítico es una <a href="https://en.wikipedia.org/wiki/Charles_Joseph_Minard">gráfica de Minard</a> que sirve para entender la campaña de Napoleón (1812) en Rusia. Es un ejemplo atípico, pero representa bien los principios y también muestra la importancia del ingenio en la construcción de un anállsis:</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="imagenes/Minard.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Marcha de Napoleón de Charles Minard. Tomado de Wikipedia</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" type="pregunta">

<div class="pregunta">
¿Cómo satisface los principios del diseño analítico este gráfico?
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-ClevelandVis" class="csl-entry" role="doc-biblioentry">
Cleveland, William S. 1993. <em>Visualizing Data</em>. Hobart Press.
</div>
<div id="ref-kidney94" class="csl-entry" role="doc-biblioentry">
Julious, Steven A, y Mark A Mullee. 1994. <span>«Confounding and Simpson<span>’</span>s paradox»</span>. <em>BMJ</em> 309 (6967): 1480-81. <a href="https://doi.org/10.1136/bmj.309.6967.1480">https://doi.org/10.1136/bmj.309.6967.1480</a>.
</div>
<div id="ref-tufte06" class="csl-entry" role="doc-biblioentry">
Tufte, Edward R. 2006. <em>Beautiful Evidence</em>. Cheshire, CT: Graphics Press.
</div>
<div id="ref-tukeyexpconf" class="csl-entry" role="doc-biblioentry">
Tukey, John W. 1980. <span>«We Need Both Exploratory and Confirmatory»</span>. <em>The American Statistician</em> 34 (1): 23-25. <a href="http://www.jstor.org/stable/2682991">http://www.jstor.org/stable/2682991</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./categoricos.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Datos categóricos</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./inferencia.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Inferencia estadística</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>